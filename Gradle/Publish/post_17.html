<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MavenCentral发布：迁移到MavenCentral--再不行动起来，你的托管的library就没了 - leobert&#x27;s blog</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">目录</li><li class="chapter-item expanded "><a href="../../Android/index.html"><strong aria-hidden="true">1.</strong> Android</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/View/index.html"><strong aria-hidden="true">1.1.</strong> View</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/View/post_1.html"><strong aria-hidden="true">1.1.1.</strong> 好玩系列：优雅的处理ButterKnife和KAE被废弃</a></li><li class="chapter-item expanded "><a href="../../Android/View/post_6.html"><strong aria-hidden="true">1.1.2.</strong> 三思系列：View体系认知(一)，内容是如何正确被展现出来的--视觉呈现概览</a></li><li class="chapter-item expanded "><a href="../../Android/View/post_7.html"><strong aria-hidden="true">1.1.3.</strong> 三思系列：为什么自定义View</a></li><li class="chapter-item expanded "><a href="../../Android/Idea/post_9.html"><strong aria-hidden="true">1.1.4.</strong> 三思系列："声明式UI"和"命令式UI"，你的理解可能是错的</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/Drawable/index.html"><strong aria-hidden="true">1.2.</strong> Drawable</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/Drawable/post_2.html"><strong aria-hidden="true">1.2.1.</strong> 三思系列：重新认识Drawable</a></li><li class="chapter-item expanded "><a href="../../Android/Drawable/post_4.html"><strong aria-hidden="true">1.2.2.</strong> 好玩系列：拥有它，XML文件少一半--更方便的处理View背景</a></li><li class="chapter-item expanded "><a href="../../Android/Drawable/post_47.html"><strong aria-hidden="true">1.2.3.</strong> 迟来的续集--Drawable+Animator，将优雅进行到底</a></li><li class="chapter-item expanded "><a href="../../Android/Drawable/post_49.html"><strong aria-hidden="true">1.2.4.</strong> 好玩系列：让ImageSpan动起来</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/Mechanism/Message/index.html"><strong aria-hidden="true">1.3.</strong> 消息机制</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/Mechanism/Message/post_8.html"><strong aria-hidden="true">1.3.1.</strong> 三思系列：Android的消息机制，一文吃透</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/Idea/post_14/index.html"><strong aria-hidden="true">1.4.</strong> 兼容</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/Idea/post_14.html"><strong aria-hidden="true">1.4.1.</strong> 好玩系列：让项目中的相册支持Heif格式图片</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/Glide/index.html"><strong aria-hidden="true">1.5.</strong> Glide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/Glide/post_15.html"><strong aria-hidden="true">1.5.1.</strong> 三思系列：Glide 4.X全方位认知 -- 模块职责概览</a></li><li class="chapter-item expanded "><a href="../../Android/Glide/post_16.html"><strong aria-hidden="true">1.5.2.</strong> 三思系列：Glide 4.X加载过程一文掌握 | Glide（二）</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/KSP/index.html"><strong aria-hidden="true">1.6.</strong> KSP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/KSP/post_24.html"><strong aria-hidden="true">1.6.1.</strong> 好玩系列 | 拥抱Kotlin Symbol Processing(KSP),项目实战</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/Base/index.html"><strong aria-hidden="true">1.7.</strong> 基础</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/Base/post_35.html"><strong aria-hidden="true">1.7.1.</strong> 孔乙己：你可知道页面和弹窗“通信“的方式有四种？</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/SysApp/index.html"><strong aria-hidden="true">1.8.</strong> 系统APP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/SysApp/post_52.html"><strong aria-hidden="true">1.8.1.</strong> 使用日历丰富产品的用户体验</a></li></ol></li><li class="chapter-item expanded "><a href="../../Android/DI/index.html"><strong aria-hidden="true">1.9.</strong> Part4-依赖注入部分</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Android/DI/post_53.html"><strong aria-hidden="true">1.9.1.</strong> Hilt进阶--一文吃透Hilt自定义与跨壁垒</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../Compose/index.html"><strong aria-hidden="true">2.</strong> Jetpack Compose</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Compose/post_21.html"><strong aria-hidden="true">2.1.</strong> Jetpack Compose | 一文理解神奇的Modifier</a></li><li class="chapter-item expanded "><a href="../../Compose/post_26.html"><strong aria-hidden="true">2.2.</strong> Jetpack Compose | 控件篇（一） -- Text、TextField、Button</a></li><li class="chapter-item expanded "><a href="../../Compose/post_27.html"><strong aria-hidden="true">2.3.</strong> Jetpack Compose | 控件篇（二） -- Icon，Image</a></li><li class="chapter-item expanded "><a href="../../Compose/post_28.html"><strong aria-hidden="true">2.4.</strong> Jetpack Compose | 控件篇（三） -- Switch、CheckBox、RadioButton</a></li><li class="chapter-item expanded "><a href="../../Compose/post_29.html"><strong aria-hidden="true">2.5.</strong> Jetpack Compose | 控件篇（四）-- Box、Row、Column</a></li><li class="chapter-item expanded "><a href="../../Compose/post_30.html"><strong aria-hidden="true">2.6.</strong> Jetpack Compose | 控件篇（五）-- Spacer、LazyRow、LazyColumn & 让Column可滑动</a></li></ol></li><li class="chapter-item expanded "><a href="../../MultiThreading/index.html"><strong aria-hidden="true">3.</strong> Java多线程</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../MultiThreading/post_33.html"><strong aria-hidden="true">3.1.</strong> 总纲</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_37.html"><strong aria-hidden="true">3.2.</strong> Java基础--图解JVM内存模型和JVM线程模型</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_38.html"><strong aria-hidden="true">3.3.</strong> Java多线程系列--掌控面试，一文吃透Synchronized锁</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_39.html"><strong aria-hidden="true">3.4.</strong> Java多线程基础--线程生命周期与线程协作详解</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_42.html"><strong aria-hidden="true">3.5.</strong> Java多线程基础--线程的创建与线程池管理</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_46.html"><strong aria-hidden="true">3.6.</strong> Java多线程系列--掌握Future，轻松获取异步任务结果</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_50.html"><strong aria-hidden="true">3.7.</strong> Java多线程系列--Fork&Join框架，分治的艺术</a></li><li class="chapter-item expanded "><a href="../../MultiThreading/post_54.html"><strong aria-hidden="true">3.8.</strong> Java多线程系列--掌握CompletableFuture，驾驭异步编程</a></li></ol></li><li class="chapter-item expanded "><a href="../../IO/index.html"><strong aria-hidden="true">4.</strong> Java IO系列</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../IO/post_55.html"><strong aria-hidden="true">4.1.</strong> Java IO 系列总纲</a></li><li class="chapter-item expanded "><a href="../../IO/post_56.html"><strong aria-hidden="true">4.2.</strong> Java IO系列 | 经典 IO</a></li><li class="chapter-item expanded "><a href="../../IO/post_57.html"><strong aria-hidden="true">4.3.</strong> Java IO 系列 | NIO-1.0一文速览</a></li><li class="chapter-item expanded "><a href="../../IO/post_58.html"><strong aria-hidden="true">4.4.</strong> Java IO系列 | NIO-1.0拾遗、NIO-2.0 & 零拷贝必吹的牛皮</a></li><li class="chapter-item expanded "><a href="../../IO/post_59.html"><strong aria-hidden="true">4.5.</strong> IO系列 | 一文掌握OKHTTP中的OKIO为什么这么OK</a></li></ol></li><li class="chapter-item expanded "><a href="../../Gradle/index.html"><strong aria-hidden="true">5.</strong> Gradle</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Gradle/Modularization/post_18.html"><strong aria-hidden="true">5.1.</strong> 组件化：三思系列：组件化场景下module依赖优雅实践方案</a></li><li class="chapter-item expanded "><a href="../../Gradle/Publish/post_17.html" class="active"><strong aria-hidden="true">5.2.</strong> MavenCentral发布：迁移到MavenCentral--再不行动起来，你的托管的library就没了</a></li><li class="chapter-item expanded "><a href="../../Gradle/post_22.html"><strong aria-hidden="true">5.3.</strong> Gradle | 依赖管理最佳实践</a></li></ol></li><li class="chapter-item expanded "><a href="../../Groovy/index.html"><strong aria-hidden="true">6.</strong> Groovy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Groovy/why_write_groovy.html"><strong aria-hidden="true">6.1.</strong> 为什么撰写这个系列</a></li><li class="chapter-item expanded "><a href="../../Groovy/post_23.html"><strong aria-hidden="true">6.2.</strong> Groovy：MOP一文打尽</a></li></ol></li><li class="chapter-item expanded "><a href="../../Review/index.html"><strong aria-hidden="true">7.</strong> Review</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Review/post_10.html"><strong aria-hidden="true">7.1.</strong> 造完了这个轮子--Mocker，却让我感到很羞愧|项目复盘</a></li><li class="chapter-item expanded "><a href="../../Review/post_40.html"><strong aria-hidden="true">7.2.</strong> 三思系列：前人用GreenDao留下的坑，全线被扣了绩效</a></li><li class="chapter-item expanded "><a href="../../Review/post_44.html"><strong aria-hidden="true">7.3.</strong> 谈一谈在两个商业项目中使用MVI架构后的感悟</a></li><li class="chapter-item expanded "><a href="../../Review/post_45.html"><strong aria-hidden="true">7.4.</strong> Review | 这三个坑你遇到了吗？</a></li></ol></li><li class="chapter-item expanded "><a href="../../repo/index.html"><strong aria-hidden="true">8.</strong> 个人项目</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../repo/DaVinCi.html"><strong aria-hidden="true">8.1.</strong> DaVinCi,取代XML编写Shape或ColorStateList的方案</a></li><li class="chapter-item expanded "><a href="../../Android/Idea/post_32.html"><strong aria-hidden="true">8.2.</strong> 好玩系列：白嫖一个优雅的类图生成工具</a></li><li class="chapter-item expanded "><a href="../../Speculative/post_43.html"><strong aria-hidden="true">8.3.</strong> 初体验：动手搭建"小清新式"局域网文档系统</a></li><li class="chapter-item expanded "><a href="../../repo/post_48.html"><strong aria-hidden="true">8.4.</strong> 研究良久，终于发现了他代码写的快且bug少的原因</a></li><li class="chapter-item expanded "><a href="../../Speculative/post_61.html"><strong aria-hidden="true">8.5.</strong> 好玩系列 | 如果后端让你用SSE接收多次返回，那我们改造Retrofit吧</a></li></ol></li><li class="chapter-item expanded "><a href="../../Review/DataStructure/index.html"><strong aria-hidden="true">9.</strong> 数据结构</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Review/DataStructure/post_11.html"><strong aria-hidden="true">9.1.</strong> 温故：线性表</a></li><li class="chapter-item expanded "><a href="../../Review/DataStructure/post_12.html"><strong aria-hidden="true">9.2.</strong> 温故：栈</a></li><li class="chapter-item expanded "><a href="../../Review/DataStructure/post_13.html"><strong aria-hidden="true">9.3.</strong> 温故：队列</a></li></ol></li><li class="chapter-item expanded "><a href="../../Review/README2.html"><strong aria-hidden="true">10.</strong> 年终总结&计划</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Review/post_36.html"><strong aria-hidden="true">10.1.</strong> 2021年终总结</a></li><li class="chapter-item expanded "><a href="../../Review/post_51.html"><strong aria-hidden="true">10.2.</strong> 关于画一个句号--基于2022年终总结的反思与分享</a></li><li class="chapter-item expanded "><a href="../../Review/post_60.html"><strong aria-hidden="true">10.3.</strong> 突如其来的秋季反思</a></li><li class="chapter-item expanded "><a href="../../Review/post_63.html"><strong aria-hidden="true">10.4.</strong> 2023年总结 寻找到源于内心深处的无穷力量</a></li><li class="chapter-item expanded "><a href="../../Review/post_64.html"><strong aria-hidden="true">10.5.</strong> 2024年中思考，推倒樊笼重新出发</a></li></ol></li><li class="chapter-item expanded "><a href="../../Note/index.html"><strong aria-hidden="true">11.</strong> 读书笔记</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Note/post_41.html"><strong aria-hidden="true">11.1.</strong> 读书笔记：《简约至上--交互式设计四策略》</a></li><li class="chapter-item expanded "><a href="../../Talk/talk_4_2024-08.html"><strong aria-hidden="true">11.2.</strong> 读书笔记 - 《团队管理》精华摘要</a></li></ol></li><li class="chapter-item expanded "><a href="../../Talk/index.html"><strong aria-hidden="true">12.</strong> 杂谈</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Talk/talk_1.html"><strong aria-hidden="true">12.1.</strong> 杂谈1-2022-11</a></li><li class="chapter-item expanded "><a href="../../Talk/talk_2_2023-03.html"><strong aria-hidden="true">12.2.</strong> 杂篇（二）-- 认识并战胜焦虑</a></li><li class="chapter-item expanded "><a href="../../Talk/talk_3_2024-08.html"><strong aria-hidden="true">12.3.</strong> 杂谈（三）-- 向钱看，你需要想明白企业在为什么而付钱</a></li></ol></li><li class="chapter-item expanded "><a href="../../Thought/index.html"><strong aria-hidden="true">13.</strong> 半成熟的思考</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Thought/post_62.html"><strong aria-hidden="true">13.1.</strong> 好玩系列 | 当SPI 和 设计模式、依赖注入发生碰撞，可以擦出怎样的火花</a></li></ol></li><li class="chapter-item expanded "><a href="../../info/index.html"><strong aria-hidden="true">14.</strong> 系列说明</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../info/about_view_series.html"><strong aria-hidden="true">14.1.</strong> 关于View系列</a></li><li class="chapter-item expanded "><a href="../../info/about_sansi_series.html"><strong aria-hidden="true">14.2.</strong> 关于三思系列</a></li><li class="chapter-item expanded "><a href="../../info/about_haowan_series.html"><strong aria-hidden="true">14.3.</strong> 关于好玩系列</a></li><li class="chapter-item expanded "><a href="../../info/about_wengu_series.html"><strong aria-hidden="true">14.4.</strong> 关于温故系列</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">leobert&#x27;s blog</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="再不行动起来你的托管的library就没了"><a class="header" href="#再不行动起来你的托管的library就没了">再不行动起来，你的托管的library就没了</a></h1>
<h2 id="前言"><a class="header" href="#前言">前言</a></h2>
<p>相信不少朋友都有自己进行维护的作品，并托管在三方Library仓库开放使用。
而距离Jcenter宣布停止对非付费用户的各项运营政策已经有一段时间了，再不行动起来，托管在Jcenter和Jfrog的 <code>library就要没了</code>。</p>
<p>本文带你走一遍 <code>sonatype账号注册</code> 、<code>申请groupId</code> 和 <code>MavenCentral发布</code> ，并提供一个更加方便的 <code>Gradle插件</code> 用于发布。</p>
<h2 id="背景"><a class="header" href="#背景">背景</a></h2>
<p>今年Jfrog宣布了 <a href="https://jfrog.com/blog/into-the-sunset-bintray-jcenter-gocenter-and-chartcenter/">这项决定</a> ：</p>
<blockquote>
<p>UPDATE: To better support the community in this migration,
JFrog has extended the JCenter new package versions submission deadline through March 31st 2021.</p>
<p>To clarify, the JCenter repository will keep serving packages for 12 months until February 1st 2022.
Only the JCenter REST API and UI will be sunsetted on May 1st 2021.</p>
</blockquote>
<p>这就很尴尬了，随着时间的推移，未付费用户托管的library将无法再被获取。</p>
<p>扯点题外话，Google也被这一波操作秀到了，按照Google的尿性，可能会在未来支撑这件事业，但毕竟八字没一撇。</p>
<p>所以，我们剩下的选择不多了：</p>
<ul>
<li>成为 <code>尊贵的付费用户</code></li>
<li>转投 <code>sonatype</code> 的怀抱，使用免费的MavenCentral</li>
</ul>
<h2 id="注册-sonatype-账户"><a class="header" href="#注册-sonatype-账户">注册 sonatype 账户</a></h2>
<p>sonatype的玩法很溜，使用了敏捷开发管理的知名工具 <code>JIRA</code> 进行事物管理，所以第一件事情是 <code>注册sonatype的JIRA账户</code></p>
<p><a href="https://issues.sonatype.org/secure/Signup!default.jspa">注册地址</a></p>
<p>按照信息指导填写即可。</p>
<h2 id="申请groupid"><a class="header" href="#申请groupid">申请GroupId</a></h2>
<blockquote>
<p>一个托管在三方仓库的Library由三个信息确定：GroupId，ArtifactId，version</p>
</blockquote>
<p>不难理解，我们需要先申请一个可用的GroupId。开始申请之前，请先阅读以下内容，避免无用操作：</p>
<blockquote>
<p>按照sonatype的运营策略，他们利用了一些巧妙的方式来管理GroupId并且规避抢注风险</p>
<p>首先分为两种类型：</p>
<ul>
<li>你拥有域名</li>
<li>你没有域名</li>
</ul>
<p>第一类的验证方法我没有测试过，拥有域名的可以按照官网介绍试一下：</p>
<ul>
<li>Add a TXT record to your DNS referencing this JIRA ticket: (JIRA-TASK-ID) (Fastest)</li>
<li>Setup a redirect to your Github page (if it does not already exist) You can find more information here: https://central.sonatype.org/publish/</li>
</ul>
<p>第二类需要利用到第三方（如：Github、Gitlab、Gitee 等）
通过第三方 "对于其用户名的唯一性约束" 和 "Pages服务"，可以得到一个托管在三方平台的网站，以github为例：
开通Pages后，简单配置可以得到网站：https://leobert-lan.github.io/</p>
</blockquote>
<h3 id="创建pages网站"><a class="header" href="#创建pages网站">创建Pages网站</a></h3>
<p><em>以github为例，Gitee等应该类似</em></p>
<p><a href="https://pages.github.com/">官方介绍</a></p>
<p>创建一个 {github_user_name}.github.io 的仓库</p>
<p><img src="post_17/pages_create.png" alt="pages_create.png" /></p>
<p><em>如果已经有个人博客，也可以利用HEXO或者Git-Book等工具，生成相关博客网页进行托管</em></p>
<p>下载仓库并添加一个 <code>不太离谱</code> 的 <code>index.html</code></p>
<p>注意：</p>
<ul>
<li>sonatype 仅关注这个域名是否存在，按照映射规则，GroupId为 io.github.{github_user_name}，如果这个域名不存在，不会颁发对应的GroupId给你</li>
<li>sonatype 并不关注网页的内容是啥（哪怕和项目无关），但不要弄得太离谱：政治、宗教、不良信息等不要乱来即可</li>
</ul>
<p>随后进入项目的设置
<img src="post_17/pages_setting.png" alt="img.png" /></p>
<p>选定分支和路径后保存，可以很快得到部署结果，部署成功后可以自行验证下。</p>
<h3 id="jira创建申请task"><a class="header" href="#jira创建申请task">JIRA创建申请task</a></h3>
<ul>
<li>点击新建Task后，类型等均为默认，简单描述你的意图；</li>
<li>按照映射规则，填写GroupId：io.github.{github_user_name} <em>gitlab、gitee同理</em></li>
<li>填写你的Github项目的仓库信息等</li>
</ul>
<p>提交后等待，一般会先有 <code>机器人</code> 进行答复，告知你平台的运营政策、相关注意事项。</p>
<p><strong>注意：不要一直盯着等待，注册时填写了邮箱，一旦流程状态发生了变更，会有邮件通知</strong></p>
<p>收到邮件后，通过备注进行回复可以改变流程状态，随后等待人工审核（如果信息均无误，可能机器直接过审）</p>
<p>随后进入账户归属权认证</p>
<h3 id="验证账号归属权"><a class="header" href="#验证账号归属权">验证账号归属权</a></h3>
<p>当然，这里是Github或者Gitee等账号的归属权。</p>
<p>前面我们利用这些平台得到了唯一的域名，但是sonatype需要判断 <code>这个域名是你的</code>，因为：</p>
<ul>
<li>账号和Pages一一对应</li>
<li>Pages和GroupId一一对应</li>
<li>Task中对GroupId进行了唯一性校验</li>
</ul>
<p>所以sonatype要求在对应的Github账号下创建一个和TaskID一致的仓库
例如：</p>
<blockquote>
<p>Please create a public repo called https://github.com/leobert-lan/OSSRH-67741 to verify github account ownership.</p>
<p>If you do not own this github account, please read:
https://central.sonatype.org/publish/requirements/coordinates/</p>
</blockquote>
<p>创建成功后，再回来评论一次推进流程，等审核通过后，就获得了GroupId</p>
<hr />
<p>到此为止我们就获取了GroupId。接下来我们需要 <code>准备签名工具</code></p>
<p><em>Library的信息全部存在pom文件中，如果没有签名机制，就有可能出现李代桃僵的事情。</em></p>
<p>这里我们需要用到 <code>GPG</code> ，<a href="https://www.gnupg.org/">gpg官网</a> ，有兴趣的可以多研究研究。</p>
<p><em>注意:macOs &gt;= 10.15时，暂无法安装gpg，你可能需要寻找一台window电脑来生成签名密钥，不用担心，密钥是可以导出的</em></p>
<h2 id="生成gpg签名密钥"><a class="header" href="#生成gpg签名密钥">生成GPG签名密钥</a></h2>
<h3 id="生成"><a class="header" href="#生成">生成</a></h3>
<pre><code class="language-shell">gpg --full-generate-key
</code></pre>
<p>使用命令进入密钥生成，</p>
<ul>
<li>选择 RSA(仅用于签名)即可</li>
<li>设置密钥长度，使用密钥默认长度 2048</li>
<li>设置过期时间，永久有效即可，<em>没必要自己折腾自己</em></li>
<li>确认信息后输入 "真实姓名"，"邮箱"，"密钥Comment"，Comment不参与任何校验、用于备注他的作用</li>
<li>确定信息或者再次修改，确认后需要输入两次密码，请不要忘记你的密码</li>
<li>生成完成后会输出信息</li>
</ul>
<p>当然，没有必要死记这些信息，</p>
<p>利用：</p>
<pre><code class="language-shell">gpg --list-keys
</code></pre>
<p>或者</p>
<pre><code class="language-shell">gpg -K
</code></pre>
<p>可以查看所有生成的key，每个key都有一段很长的ID，这是其公钥的ID，长41位，当然，它的后八位也可以作为其ID，在使用上两者是等价的，一般用 <code>后八位</code> 即可。</p>
<h3 id="上传公钥到公共服务器"><a class="header" href="#上传公钥到公共服务器">上传公钥到公共服务器</a></h3>
<p>我选择了"pool.sks-keyservers.net"，当然还有其他公共服务器可以托管。</p>
<pre><code class="language-shell">gpg --keyserver hkp://pool.sks-keyservers.net --send-keys 公钥 ID
</code></pre>
<p>检查是否上传成功：</p>
<pre><code class="language-shell">gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys 公钥 ID
</code></pre>
<h3 id="导出公钥密钥钥匙串keyring"><a class="header" href="#导出公钥密钥钥匙串keyring">导出公钥、密钥、钥匙串（KeyRing）</a></h3>
<pre><code class="language-shell">#导出公钥到 public-file.key 文件：
gpg -a -o public-file.key --export KeyId 

#导出私钥到 private-file.key 文件：
gpg -a -o private-file.key --export-secret-keys KeyId

#导出钥匙串到 secring.gpg 文件：
gpg --keyring secring.gpg --export-secret-keys
</code></pre>
<p>保管好你的钥匙！！</p>
<h2 id="配置项目"><a class="header" href="#配置项目">配置项目</a></h2>
<p>此时，我们的准备工作已经到位，开始修改你的项目：</p>
<h3 id="更改plugin"><a class="header" href="#更改plugin">更改plugin</a></h3>
<p>考虑到 <code>Gradle 7.0</code> 会弃用 <code>maven插件</code> ，我们选用 <code>maven-publish</code> 插件</p>
<pre><code class="language-groovy">plugins {
//    其他必要的插件
    
    id 'signing'
    id 'maven-publish'
}
</code></pre>
<p>添加 <code>maven-publish</code> 用于发布
添加 <code>signing</code> 用于签名</p>
<h3 id="添加签名的必要信息"><a class="header" href="#添加签名的必要信息">添加签名的必要信息</a></h3>
<pre><code class="language-properties">signing.keyId=公钥ID，后八位即可
signing.password= GPG密钥的密码
signing.secretKeyRingFile=/Users/leobert/.gnupg/secring.gpg #钥匙串地址
</code></pre>
<p>比较遗憾的是我没有找到在local.properties中配置的方法，似乎signing插件内部直接读取了属性。</p>
<p>考虑到密钥安全性，可以将gradle.properties 文件从Git中移除并忽略。</p>
<h3 id="配置生成javadoc和sources的task"><a class="header" href="#配置生成javadoc和sources的task">配置生成JavaDoc和Sources的Task</a></h3>
<pre><code class="language-groovy">task sourcesJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.java.srcDirs
}

//android 项目需要额外定义一下task，java-library等项目插件自带task
//task javadoc(type: Javadoc) {
//    source = android.sourceSets.main.java.srcDirs
//    classpath += project.files(android.getBootClasspath().join(File.pathSeparator))
//}

task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
}

tasks.withType(Javadoc) {
    options.addStringOption('Xdoclint:none', '-quiet')
    options.addStringOption('encoding', 'UTF-8')
    options.addStringOption('charSet', 'UTF-8')
}
</code></pre>
<p><em>注意：android 项目需要额外定义一下javadoc 的 task，java-library等项目插件自带task，并注意路径</em></p>
<h3 id="配置发布信息"><a class="header" href="#配置发布信息">配置发布信息</a></h3>
<p>注意，在任务Evaluated之后进行配置，即配置在 <code>afterEvaluate</code> 闭包内</p>
<pre><code class="language-groovy">afterEvaluate {
    publishing {
        publications {
            mavenAndroid(MavenPublication) {
                groupId GROUP_ID
                artifactId ARTIFACT_ID
                version VERSION_NAME
                artifact sourcesJar
                artifact javadocJar
                artifact('build/libs/xxx.jar') //
                // 配置 pom 文件格式
                pom {
                    packaging = 'jar'
                    name = ARTIFACT_ID
                    description = ARTIFACT_ID
                    url = siteUrl
                    licenses {
                        license {
                            name = 'The Apache Software License, Version 2.0'
                            url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
                        }
                    }
                    developers {
                        developer {
                            id = 'leobert'
                            name = 'leobert'
                            email = 'leobert.l@hotmail.com'
                        }
                    }
                    scm {
                        connection = siteUrl
                        developerConnection = gitUrl
                        url = siteUrl
                    }
                }
            }
        }
        // 配置远程仓库
        repositories {
            maven {
                url = 'https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/'
                credentials {
                    username ACCOUNT
                    password PASSWORD
                }
            }
        }
    }

    signing {
        sign publishing.publications.mavenAndroid
    }
}
</code></pre>
<p>这是一个简单的样板，当然，协议部分、开发者部分、贡献者部分等还可以继续扩展。
<code>ACCOUNT</code> 和 <code>PASSWORD</code> 为sonatype的账密，</p>
<p>build之后，执行publish task 即可进行签名和上传</p>
<h2 id="最后一步"><a class="header" href="#最后一步">最后一步</a></h2>
<p>使用sonatype的账密 登录 <a href="https://s01.oss.sonatype.org/#stagingRepositories">sonatype 的maven仓库</a></p>
<p>左侧导航进入：stagingRepositories，找到提交的内容，再次检查下所有的校验已通过，close，刷新后进行release。</p>
<p>确认成功后，关闭sonatype-jira的task。</p>
<p><em>上述操作成功后，提交的Components应当已经进入sonatype的release仓库，大约1小时内同步到MavenCentral</em></p>
<p>之后更新版本，理论上会自动同步。</p>
<h2 id="编写gradle插件让配置更加简单"><a class="header" href="#编写gradle插件让配置更加简单">编写Gradle插件让配置更加简单</a></h2>
<p>其实maven-publish插件还支持更加复杂的配置，但个人项目中可能很少用到，挑选了"够用"的配置项后，我们编写一个Gradle插件，
这样可以省略重复样板。</p>
<p><a href="https://github.com/leobert-lan/EsayPublish">插件源码仓库</a>,</p>
<ul>
<li>gradle.properties 中 写入签名必要的信息</li>
</ul>
<blockquote>
<p>考虑到本篇的主题是分享MavenCentral发布的经验，略去Gradle插件的相关知识，以及本插件的源码介绍。有兴趣的朋友可以<strong>通过仓库的源码自行了解</strong>。</p>
<p><em>PS：很多时候我们都是copy了野生配置，而且往往是Groovy代码，出于Groovy语言的特殊性，这些闭包配置项出现错误时，大概率会被兼容，插件使用Kotlin编写，
阅读其源码可以加深对于maven-publish等插件API的认知</em></p>
</blockquote>
<pre><code class="language-properties">signing.keyId=公钥ID，后八位即可
signing.password= GPG密钥的密码
signing.secretKeyRingFile=/Users/leobert/.gnupg/secring.gpg #钥匙串地址
</code></pre>
<ul>
<li>local.properties 中写入sonatype 账密信息：</li>
</ul>
<pre><code class="language-properties">nexus_user=sonatype账号
nexus_pwd= sonatype密码
</code></pre>
<ul>
<li>引入插件后，build.gradle进行必要的配置：</li>
</ul>
<pre><code class="language-groovy">plugins {
    id 'osp.leobert.maven.publish'
}

EasyPublish {
    sourceSet = android.sourceSets.main.java.srcDirs
    docClassPathAppend = project.files(android.getBootClasspath().join(File.pathSeparator)).asPath
    docExcludes = ["a/b/c/*"]
    artifact {
        value = "build/outputs/aar/android-lib-demo-release.aar"
    }

    developer {
        id = 'leobert'
        name = 'leobert'
        email = 'leobert.l@hotmail.com'
    }

    //append developers
//    developer {
//        id = 'aa'
//        name = 'bb'
//        email = 'cc'
//    }

    groupId = "io.github.leobert-lan"
    artifactId = "android-demo"
    version = "1.0.0"
    packaging = "aar"
    siteUrl = "https://github.com/leobert-lan/EsayPublish"
    gitUrl = "https://github.com/leobert-lan/EsayPublish.git"
    licenseName = 'Apache 2.0'
    licenseUrl = 'https://github.com/leobert-lan/EsayPublish/blob/master/LICENSE'

    mavenRepoUrl = "https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/"
}
</code></pre>
<p>即可进行发布。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../Gradle/Modularization/post_18.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../Gradle/post_22.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../Gradle/Modularization/post_18.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../Gradle/post_22.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
